
char directoryListingTemplate[] = "<!DOCTYPE html>\n\n<html dir=\"ltr\" lang=\"en\">\n\n<head>\n<meta charset=\"utf-8\">\n<meta name=\"google\" value=\"notranslate\">\n\n<script>\nfunction addRow(name, url, isdir,\n    size, size_string, date_modified, date_modified_string) {\n  if (name == \".\" || name == \"..\")\n    return;\n\n  var root = document.location.pathname;\n  if (root.substr(-1) !== \"/\")\n    root += \"/\";\n\n  var tbody = document.getElementById(\"tbody\");\n  var row = document.createElement(\"tr\");\n  var file_cell = document.createElement(\"td\");\n  var link = document.createElement(\"a\");\n\n  link.className = isdir ? \"icon dir\" : \"icon file\";\n\n  if (isdir) {\n    name = name + \"/\";\n    url = url + \"/\";\n    size = 0;\n    size_string = \"\";\n  } else {\n    link.draggable = \"true\";\n    link.addEventListener(\"dragstart\", onDragStart, false);\n  }\n  link.innerText = name;\n  link.href = root + url;\n\n  file_cell.dataset.value = name;\n  file_cell.appendChild(link);\n\n  row.appendChild(file_cell);\n  row.appendChild(createCell(size, size_string));\n  row.appendChild(createCell(date_modified, date_modified_string));\n\n  tbody.appendChild(row);\n}\n\nfunction onDragStart(e) {\n  var el = e.srcElement;\n  var name = el.innerText.replace(\":\", \"\");\n  var download_url_data = \"application/octet-stream:\" + name + \":\" + el.href;\n  e.dataTransfer.setData(\"DownloadURL\", download_url_data);\n  e.dataTransfer.effectAllowed = \"copy\";\n}\n\nfunction createCell(value, text) {\n  var cell = document.createElement(\"td\");\n  cell.setAttribute(\"class\", \"detailsColumn\");\n  cell.dataset.value = value;\n  cell.innerText = text;\n  return cell;\n}\n\nfunction start(location) {\n  var header = document.getElementById(\"header\");\n  header.innerText = header.innerText.replace(\"LOCATION\", location);\n\n  document.getElementById(\"title\").innerText = header.innerText;\n}\n\nfunction onHasParentDirectory() {\n  var box = document.getElementById(\"parentDirLinkBox\");\n  box.style.display = \"block\";\n\n  var root = document.location.pathname;\n  if (!root.endsWith(\"/\"))\n    root += \"/\";\n\n  var link = document.getElementById(\"parentDirLink\");\n  link.href = root + \"..\";\n}\n\nfunction onListingParsingError() {\n  var box = document.getElementById(\"listingParsingErrorBox\");\n  box.innerHTML = box.innerHTML.replace(\"LOCATION\", encodeURI(document.location)\n      + \"?raw\");\n  box.style.display = \"block\";\n}\n\nfunction sortTable(column) {\n  var theader = document.getElementById(\"theader\");\n  var oldOrder = theader.cells[column].dataset.order || '1';\n  oldOrder = parseInt(oldOrder, 10)\n  var newOrder = 0 - oldOrder;\n  theader.cells[column].dataset.order = newOrder;\n\n  var tbody = document.getElementById(\"tbody\");\n  var rows = tbody.rows;\n  var list = [], i;\n  for (i = 0; i < rows.length; i++) {\n    list.push(rows[i]);\n  }\n\n  list.sort(function(row1, row2) {\n    var a = row1.cells[column].dataset.value;\n    var b = row2.cells[column].dataset.value;\n    if (column) {\n      a = parseInt(a, 10);\n      b = parseInt(b, 10);\n      return a > b ? newOrder : a < b ? oldOrder : 0;\n    }\n\n    // Column 0 is text.\n    if (a > b)\n      return newOrder;\n    if (a < b)\n      return oldOrder;\n    return 0;\n  });\n\n  // Appending an existing child again just moves it.\n  for (i = 0; i < list.length; i++) {\n    tbody.appendChild(list[i]);\n  }\n}\n\n// Add event handlers to column headers.\nfunction addHandlers(element, column) {\n  element.onclick = (e) => sortTable(column);\n  element.onkeydown = (e) => {\n    if (e.key == 'Enter' || e.key == ' ') {\n      sortTable(column);\n      e.preventDefault();\n    }\n  };\n}\n\nfunction onLoad() {\n  addHandlers(document.getElementById('nameColumnHeader'), 0);\n  addHandlers(document.getElementById('sizeColumnHeader'), 1);\n  addHandlers(document.getElementById('dateColumnHeader'), 2);\n}\n\nwindow.addEventListener('DOMContentLoaded', onLoad);\n</script>\n\n<style>\n\n  h1 {\n    border-bottom: 1px solid #c0c0c0;\n    margin-bottom: 10px;\n    padding-bottom: 10px;\n    white-space: nowrap;\n  }\n\n  table {\n    border-collapse: collapse;\n  }\n\n  th {\n    cursor: pointer;\n  }\n\n  td.detailsColumn {\n    -webkit-padding-start: 2em;\n    text-align: end;\n    white-space: nowrap;\n  }\n\n  a.icon {\n    -webkit-padding-start: 1.5em;\n    text-decoration: none;\n    user-select: auto;\n  }\n\n  a.icon:hover {\n    text-decoration: underline;\n  }\n\n  a.file {\n    background : url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAABnRSTlMAAAAAAABupgeRAAABHUlEQVR42o2RMW7DIBiF3498iHRJD5JKHurL+CRVBp+i2T16tTynF2gO0KSb5ZrBBl4HHDBuK/WXACH4eO9/CAAAbdvijzLGNE1TVZXfZuHg6XCAQESAZXbOKaXO57eiKG6ft9PrKQIkCQqFoIiQFBGlFIB5nvM8t9aOX2Nd18oDzjnPgCDpn/BH4zh2XZdlWVmWiUK4IgCBoFMUz9eP6zRN75cLgEQhcmTQIbl72O0f9865qLAAsURAAgKBJKEtgLXWvyjLuFsThCSstb8rBCaAQhDYWgIZ7myM+TUBjDHrHlZcbMYYk34cN0YSLcgS+wL0fe9TXDMbY33fR2AYBvyQ8L0Gk8MwREBrTfKe4TpTzwhArXWi8HI84h/1DfwI5mhxJamFAAAAAElFTkSuQmCC \") left top no-repeat;\n  }\n\n  a.dir {\n    background : url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAd5JREFUeNqMU79rFUEQ/vbuodFEEkzAImBpkUabFP4ldpaJhZXYm/RiZWsv/hkWFglBUyTIgyAIIfgIRjHv3r39MePM7N3LcbxAFvZ2b2bn22/mm3XMjF+HL3YW7q28YSIw8mBKoBihhhgCsoORot9d3/ywg3YowMXwNde/PzGnk2vn6PitrT+/PGeNaecg4+qNY3D43vy16A5wDDd4Aqg/ngmrjl/GoN0U5V1QquHQG3q+TPDVhVwyBffcmQGJmSVfyZk7R3SngI4JKfwDJ2+05zIg8gbiereTZRHhJ5KCMOwDFLjhoBTn2g0ghagfKeIYJDPFyibJVBtTREwq60SpYvh5++PpwatHsxSm9QRLSQpEVSd7/TYJUb49TX7gztpjjEffnoVw66+Ytovs14Yp7HaKmUXeX9rKUoMoLNW3srqI5fWn8JejrVkK0QcrkFLOgS39yoKUQe292WJ1guUHG8K2o8K00oO1BTvXoW4yasclUTgZYJY9aFNfAThX5CZRmczAV52oAPoupHhWRIUUAOoyUIlYVaAa/VbLbyiZUiyFbjQFNwiZQSGl4IDy9sO5Wrty0QLKhdZPxmgGcDo8ejn+c/6eiK9poz15Kw7Dr/vN/z6W7q++091/AQYA5mZ8GYJ9K0AAAAAASUVORK5CYII= \") left top no-repeat;\n  }\n\n  a.up {\n    background : url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAmlJREFUeNpsU0toU0EUPfPysx/tTxuDH9SCWhUDooIbd7oRUUTMouqi2iIoCO6lceHWhegy4EJFinWjrlQUpVm0IIoFpVDEIthm0dpikpf3ZuZ6Z94nrXhhMjM3c8895977BBHB2PznK8WPtDgyWH5q77cPH8PpdXuhpQT4ifR9u5sfJb1bmw6VivahATDrxcRZ2njfoaMv+2j7mLDn93MPiNRMvGbL18L9IpF8h9/TN+EYkMffSiOXJ5+hkD+PdqcLpICWHOHc2CC+LEyA/K+cKQMnlQHJX8wqYG3MAJy88Wa4OLDvEqAEOpJd0LxHIMdHBziowSwVlF8D6QaicK01krw/JynwcKoEwZczewroTvZirlKJs5CqQ5CG8pb57FnJUA0LYCXMX5fibd+p8LWDDemcPZbzQyjvH+Ki1TlIciElA7ghwLKV4kRZstt2sANWRjYTAGzuP2hXZFpJ/GsxgGJ0ox1aoFWsDXyyxqCs26+ydmagFN/rRjymJ1898bzGzmQE0HCZpmk5A0RFIv8Pn0WYPsiu6t/Rsj6PauVTwffTSzGAGZhUG2F06hEc9ibS7OPMNp6ErYFlKavo7MkhmTqCxZ/jwzGA9Hx82H2BZSw1NTN9Gx8ycHkajU/7M+jInsDC7DiaEmo1bNl1AMr9ASFgqVu9MCTIzoGUimXVAnnaN0PdBBDCCYbEtMk6wkpQwIG0sn0PQIUF4GsTwLSIFKNqF6DVrQq+IWVrQDxAYQC/1SsYOI4pOxKZrfifiUSbDUisif7XlpGIPufXd/uvdvZm760M0no1FZcnrzUdjw7au3vu/BVgAFLXeuTxhTXVAAAAAElFTkSuQmCC \") left top no-repeat;\n  }\n\n  html[dir=rtl] a {\n    background-position-x: right;\n  }\n\n  #parentDirLinkBox {\n    margin-bottom: 10px;\n    padding-bottom: 10px;\n  }\n\n  #listingParsingErrorBox {\n    border: 1px solid black;\n    background: #fae691;\n    padding: 10px;\n    display: none;\n  }\n</style>\n\n<title id=\"title\"></title>\n\n</head>\n\n<body>\n\n<div id=\"listingParsingErrorBox\">Oh, no! This server is sending data Google Chrome can't understand. Please <a href=\"http://code.google.com/p/chromium/issues/entry\">report a bug</a>, and include the <a href=\"LOCATION\">raw listing</a>.</div>\n\n<h1 id=\"header\">Index of LOCATION</h1>\n\n<div id=\"parentDirLinkBox\" style=\"display:none\">\n  <a id=\"parentDirLink\" class=\"icon up\">\n    <span id=\"parentDirText\">[parent directory]</span>\n  </a>\n</div>\n\n<table>\n  <thead>\n    <tr class=\"header\" id=\"theader\">\n      <th id=\"nameColumnHeader\" tabindex=0 role=\"button\">Name</th>\n      <th id=\"sizeColumnHeader\" class=\"detailsColumn\" tabindex=0 role=\"button\">\n        Size\n      </th>\n      <th id=\"dateColumnHeader\" class=\"detailsColumn\" tabindex=0 role=\"button\">\n        Date Modified\n      </th>\n    </tr>\n  </thead>\n  <tbody id=\"tbody\">\n  </tbody>\n</table>\n\n</body>\n\n</html>\n<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/**\n * @fileoverview This file defines a singleton which provides access to all data\n * that is available as soon as the page's resources are loaded (before DOM\n * content has finished loading). This data includes both localized strings and\n * any data that is important to have ready from a very early stage (e.g. things\n * that must be displayed right away).\n *\n * Note that loadTimeData is not guaranteed to be consistent between page\n * refreshes (https://crbug.com/740629) and should not contain values that might\n * change if the page is re-opened later.\n */\n\n// #import {assert} from './assert.m.js';\n// #import {parseHtmlSubset} from './parse_html_subset.m.js';\n\n/**\n * @typedef {{\n *   substitutions: (!Array<string>|undefined),\n *   attrs: (!Array<string>|undefined),\n *   tags: (!Array<string>|undefined),\n * }}\n */\n/* #export */ let SanitizeInnerHtmlOpts;\n\n// eslint-disable-next-line no-var\n/* #export */ /** @type {!LoadTimeData} */ var loadTimeData;\n\nclass LoadTimeData {\n  constructor() {\n    /** @type {Object} */\n    this.data_;\n  }\n\n  /**\n   * Sets the backing object.\n   *\n   * Note that there is no getter for |data_| to discourage abuse of the form:\n   *\n   *     var value = loadTimeData.data()['key'];\n   *\n   * @param {Object} value The de-serialized page data.\n   */\n  set data(value) {\n    expect(!this.data_, 'Re-setting data.');\n    this.data_ = value;\n  }\n\n  /**\n   * Returns a JsEvalContext for |data_|.\n   * @returns {JsEvalContext}\n   */\n  createJsEvalContext() {\n    return new JsEvalContext(this.data_);\n  }\n\n  /**\n   * @param {string} id An ID of a value that might exist.\n   * @return {boolean} True if |id| is a key in the dictionary.\n   */\n  valueExists(id) {\n    return id in this.data_;\n  }\n\n  /**\n   * Fetches a value, expecting that it exists.\n   * @param {string} id The key that identifies the desired value.\n   * @return {*} The corresponding value.\n   */\n  getValue(id) {\n    expect(this.data_, 'No data. Did you remember to include strings.js?');\n    const value = this.data_[id];\n    expect(typeof value !== 'undefined', 'Could not find value for ' + id);\n    return value;\n  }\n\n  /**\n   * As above, but also makes sure that the value is a string.\n   * @param {string} id The key that identifies the desired string.\n   * @return {string} The corresponding string value.\n   */\n  getString(id) {\n    const value = this.getValue(id);\n    expectIsType(id, value, 'string');\n    return /** @type {string} */ (value);\n  }\n\n  /**\n   * Returns a formatted localized string where $1 to $9 are replaced by the\n   * second to the tenth argument.\n   * @param {string} id The ID of the string we want.\n   * @param {...(string|number)} var_args The extra values to include in the\n   *     formatted output.\n   * @return {string} The formatted string.\n   */\n  getStringF(id, var_args) {\n    const value = this.getString(id);\n    if (!value) {\n      return '';\n    }\n\n    const args = Array.prototype.slice.call(arguments);\n    args[0] = value;\n    return this.substituteString.apply(this, args);\n  }\n\n  /**\n   * Make a string safe for use with with Polymer bindings that are\n   * inner-h-t-m-l (or other innerHTML use).\n   * @param {string} rawString The unsanitized string.\n   * @param {SanitizeInnerHtmlOpts=} opts Optional additional allowed tags and\n   *     attributes.\n   * @return {string}\n   */\n  sanitizeInnerHtml(rawString, opts) {\n    opts = opts || {};\n    return parseHtmlSubset('<b>' + rawString + '</b>', opts.tags, opts.attrs)\n        .firstChild.innerHTML;\n  }\n\n  /**\n   * Returns a formatted localized string where $1 to $9 are replaced by the\n   * second to the tenth argument. Any standalone $ signs must be escaped as\n   * $$.\n   * @param {string} label The label to substitute through.\n   *     This is not an resource ID.\n   * @param {...(string|number)} var_args The extra values to include in the\n   *     formatted output.\n   * @return {string} The formatted string.\n   */\n  substituteString(label, var_args) {\n    const varArgs = arguments;\n    return label.replace(/\\$(.|$|\\n)/g, function(m) {\n      assert(m.match(/\\$[$1-9]/), 'Unescaped $ found in localized string.');\n      return m === '$$' ? '$' : varArgs[m[1]];\n    });\n  }\n\n  /**\n   * Returns a formatted string where $1 to $9 are replaced by the second to\n   * tenth argument, split apart into a list of pieces describing how the\n   * substitution was performed. Any standalone $ signs must be escaped as $$.\n   * @param {string} label A localized string to substitute through.\n   *     This is not an resource ID.\n   * @param {...(string|number)} var_args The extra values to include in the\n   *     formatted output.\n   * @return {!Array<!{value: string, arg: (null|string)}>} The formatted\n   *     string pieces.\n   */\n  getSubstitutedStringPieces(label, var_args) {\n    const varArgs = arguments;\n    // Split the string by separately matching all occurrences of $1-9 and of\n    // non $1-9 pieces.\n    const pieces = (label.match(/(\\$[1-9])|(([^$]|\\$([^1-9]|$))+)/g) ||\n                    []).map(function(p) {\n      // Pieces that are not $1-9 should be returned after replacing $$\n      // with $.\n      if (!p.match(/^\\$[1-9]$/)) {\n        assert(\n            (p.match(/\\$/g) || []).length % 2 === 0,\n            'Unescaped $ found in localized string.');\n        return {value: p.replace(/\\$\\$/g, '$'), arg: null};\n      }\n\n      // Otherwise, return the substitution value.\n      return {value: varArgs[p[1]], arg: p};\n    });\n\n    return pieces;\n  }\n\n  /**\n   * As above, but also makes sure that the value is a boolean.\n   * @param {string} id The key that identifies the desired boolean.\n   * @return {boolean} The corresponding boolean value.\n   */\n  getBoolean(id) {\n    const value = this.getValue(id);\n    expectIsType(id, value, 'boolean');\n    return /** @type {boolean} */ (value);\n  }\n\n  /**\n   * As above, but also makes sure that the value is an integer.\n   * @param {string} id The key that identifies the desired number.\n   * @return {number} The corresponding number value.\n   */\n  getInteger(id) {\n    const value = this.getValue(id);\n    expectIsType(id, value, 'number');\n    expect(value === Math.floor(value), 'Number isn\\'t integer: ' + value);\n    return /** @type {number} */ (value);\n  }\n\n  /**\n   * Override values in loadTimeData with the values found in |replacements|.\n   * @param {Object} replacements The dictionary object of keys to replace.\n   */\n  overrideValues(replacements) {\n    expect(\n        typeof replacements === 'object',\n        'Replacements must be a dictionary object.');\n    for (const key in replacements) {\n      this.data_[key] = replacements[key];\n    }\n  }\n}\n\n  /**\n   * Checks condition, displays error message if expectation fails.\n   * @param {*} condition The condition to check for truthiness.\n   * @param {string} message The message to display if the check fails.\n   */\n  function expect(condition, message) {\n    if (!condition) {\n      console.error(\n          'Unexpected condition on ' + document.location.href + ': ' + message);\n    }\n  }\n\n  /**\n   * Checks that the given value has the given type.\n   * @param {string} id The id of the value (only used for error message).\n   * @param {*} value The value to check the type on.\n   * @param {string} type The type we expect |value| to be.\n   */\n  function expectIsType(id, value, type) {\n    expect(\n        typeof value === type, '[' + value + '] (' + id + ') is not a ' + type);\n  }\n\n  expect(!loadTimeData, 'should only include this file once');\n  loadTimeData = new LoadTimeData;\n\n  // Expose |loadTimeData| directly on |window|. This is only necessary by the\n  // auto-generated load_time_data.m.js, since within a JS module the scope is\n  // local.\n  window.loadTimeData = loadTimeData;\n\n/* #ignore */ console.warn('crbug/1173575, non-JS module files deprecated.');\n    \n document.addEventListener(\"DOMContentLoaded\", function(e) {\n    console.log(\"DOM CONTENT LOADED\")\n    // apparently for drop to work everywhere, you have to prevent default for enter/over/leave\n    // but we lose the cool icon hmm -- tried dropEffect \"copy\" everywhere, seems to work\n    // http://www.quirksmode.org/blog/archives/2009/09/the_html5_drag.html\n    document.addEventListener(\"dragover\", dragOver, false);\n    document.addEventListener(\"dragleave\", dragLeave, false);\n    document.addEventListener(\"dragenter\", dragEnter, false);\n    document.addEventListener(\"drop\", drop, false);\n})\n\nfunction dragOver(evt) {\n    console.log(arguments.callee.name)\n    evt.dataTransfer.dropEffect = 'copy'\n    evt.preventDefault();\n    return false;\n}\nfunction dragLeave(evt) {\n    console.log(arguments.callee.name)\n    evt.dataTransfer.dropEffect = 'copy'\n    evt.preventDefault();\n    return false;\n}\nfunction dragEnter(evt) {\n    console.log(arguments.callee.name)\n    evt.dataTransfer.dropEffect = 'copy'\n    evt.preventDefault();\n    return false;\n}\nfunction drop(evt) {\n    console.log(arguments.callee.name)\n    evt.dataTransfer.dropEffect = 'copy'\n    evt.preventDefault();\n    handleDrop(evt)\n    return false;\n}\n\nfunction handleDrop(evt) {\n        var items = evt.dataTransfer.items\n        if (items) {\n            for (var i=0; i<items.length; i++) {\n                item = items[i]\n                //console.log('drop found item',item)\n                if (item.kind == 'file') {\n                    var entry = item.webkitGetAsEntry()\n                    handleEntry(entry)\n                }\n            }\n        }\n}\n\nfunction handleEntry(entry) {\n    console.log('handle entry',entry)\n\n    function onread(evt) {\n        doupload(entry, evt.target.result)\n    }\n\n    var fr = new FileReader\n    fr.onload = fr.onerror = onread\n\n    entry.file( function(f) {\n        fr.readAsArrayBuffer(f)\n    })\n}\n\nfunction doupload(entry, data) {\n    console.log('doupload',entry,data)\n    fetch(window.location.pathname + encodeURIComponent(entry.name), {method:'PUT',body:data}).then(\n                                          function(r){console.log('upload resp',r); window.location.reload()}).catch(\n                                          function(e){console.log('upload err',e)})\n}\n</script><script>loadTimeData.data = {\"header\":\"Index of LOCATION\",\"headerDateModified\":\"Date Modified\",\"headerName\":\"Name\",\"headerSize\":\"Size\",\"language\":\"en\",\"listingParsingErrorBoxText\":\"Oh, no! This server is sending data Google Chrome can't understand. Please \\u003Ca href=\\\"http://code.google.com/p/chromium/issues/entry\\\">report a bug\\u003C/a>, and include the \\u003Ca href=\\\"LOCATION\\\">raw listing\\u003C/a>.\",\"parentDirText\":\"[parent directory]\",\"textdirection\":\"ltr\"};</script>\n";
